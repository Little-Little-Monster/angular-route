<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />
	<title>demo</title>
	<link rel="stylesheet" href="css/swiper-3.4.0.min.css" />
	<link rel="stylesheet" href="css/animate.css" />
	<link rel="stylesheet" href="css/index.css" />
	<script type="text/javascript" src="js/angular.js"></script>
	<script type="text/javascript" src="js/zepto.min.js"></script>
	<script type="text/javascript" src="js/iscroll-probe.js"></script>
	<script type="text/javascript" src="js/swiper-3.4.0.min.js"></script>
</head>
<body>
	<header>
		<nav>
			<div class="swiper-container">
			    <div class="swiper-wrapper">
			        <div class="swiper-slide"><span>已结束</span></div>
			        <div class="swiper-slide"><span class="active">11月19号</span></div>
			        <div class="swiper-slide"><span>11月20号</span></div>
			    	<div class="swiper-slide"><span>11月21号</span></div>
			        <div class="swiper-slide"><span>11月22号</span></div>
			        <div class="swiper-slide"><span>11月23号</span></div>
			    	<div class="swiper-slide"><span>11月24号</span></div>
			        <div class="swiper-slide"><span>11月25号</span></div>
			    </div>
			</div>
		</nav>
		<div class="time">
			<p>
				<span>距离开拍结束</span>
				<span>22:33:55</span>
			</p>
		</div>
	</header>
		<section id="wrapper">
		<div id="scroller">
		    <div id="downTag" style="height: 40px;width:100%;background-color: #f3f3f3;text-align: center; line-height: 40px;">下拉
		    </div> 
			<ul>
				<li>
					<p class="edit">
						<b>&#xe606;</b>
						<b>&#xe74b;</b>
					</p>
					<dl>
						<dt><img src="img/1.jpg"/></dt>
						<dd>
							<b>300头</b>
							<p>绵阳三台希望猪场</p>
							<p>地址：四川省德阳三台</p>
						</dd>
					</dl>
					<div class="con">
						<span class="price">价格:</span>
						<p class="info">
							<span>￥18.86元/kg <i>(均重100-110kg)</i></span>
							<span>￥18.86元/kg <i>(均重100-110kg)</i></span>
							<span>￥18.86元/kg <i>(均重100-110kg)</i></span>
						</p>
					</div>
				</li>
				<li>
					<p class="edit">
						<b>&#xe606;</b>
						<b>&#xe74b;</b>
					</p>
					<dl>
						<dt><img src="img/2.jpg"/></dt>
						<dd>
							<b>300头</b>
							<p>绵阳三台希望猪场</p>
							<p>地址：四川省德阳三台</p>
						</dd>
					</dl>
					<div class="con">
						<span class="price">价格:</span>
						<p class="info">
							<span>￥18.86元/kg <i>(均重100-110kg)</i></span>
							<span>￥18.86元/kg <i>(均重100-110kg)</i></span>
							<span>￥18.86元/kg <i>(均重100-110kg)</i></span>
						</p>
					</div>
				</li>
				<li>
					<p class="edit">
						<b>&#xe606;</b>
						<b>&#xe74b;</b>
					</p>
					<dl>
						<dt><img src="img/3.jpg"/></dt>
						<dd>
							<b>300头</b>
							<p>绵阳三台希望猪场</p>
							<p>地址：四川省德阳三台</p>
						</dd>
					</dl>
					<div class="con">
						<span class="price">价格:</span>
						<p class="info">
							<span>￥18.86元/kg <i>(均重100-110kg)</i></span>
							<span>￥18.86元/kg <i>(均重100-110kg)</i></span>
							<span>￥18.86元/kg <i>(均重100-110kg)</i></span>
						</p>
					</div>
				</li>
				<li>
					<p class="edit">
						<b>&#xe606;</b>
						<b>&#xe74b;</b>
					</p>
					<dl>
						<dt><img src="img/4.jpg"/></dt>
						<dd>
							<b>300头</b>
							<p>绵阳三台希望猪场</p>
							<p>地址：四川省德阳三台</p>
						</dd>
					</dl>
					<div class="con">
						<span class="price">价格:</span>
						<p class="info">
							<span>￥18.86元/kg <i>(均重100-110kg)</i></span>
							<span>￥18.86元/kg <i>(均重100-110kg)</i></span>
							<span>￥18.86元/kg <i>(均重100-110kg)</i></span>
						</p>
					</div>
				</li>
				<li>
					<p class="edit">
						<b>&#xe606;</b>
						<b>&#xe74b;</b>
					</p>
					<dl>
						<dt><img src="img/5.jpg"/></dt>
						<dd>
							<b>300头</b>
							<p>绵阳三台希望猪场</p>
							<p>地址：四川省德阳三台</p>
						</dd>
					</dl>
					<div class="con">
						<span class="price">价格:</span>
						<p class="info">
							<span>￥18.86元/kg <i>(均重100-110kg)</i></span>
							<span>￥18.86元/kg <i>(均重100-110kg)</i></span>
							<span>￥18.86元/kg <i>(均重100-110kg)</i></span>
						</p>
					</div>
				</li>
			</ul>
			<div id="upTag" style="height: 40px;width:100%;background-color: #f3f3f3;text-align: center; line-height: 40px;margin-bottom:-40px">上拉
		    </div>
		</div>
		</section>
</body>

<script>
$(function(){
	var swiper1 = new Swiper(".swiper-container",{
		slidesPerView : 3,
		slidesPerGroup : 3,
	});


	var myScroll,downTag,
    downTag = document.querySelector("#downTag"),
    upTag = document.querySelector("#upTag"),
    flag = "",
    ulDom = document.querySelector("#wrapper ul"),
    maxScrollY=0;

	myScroll = new IScroll('#wrapper', {
              probeType:2,
              startY:-40
		     });
    maxScrollY = myScroll.maxScrollY;
    myScroll.on('scroll',function() {
    	console.log(this.y+'='+this.maxScrollY);
    //console.log(this.directionY)

        if (this.y > 5 && !flag && this.directionY==-1) {//当
           downTag.innerHTML="释放刷新！";
           flag="down";
        }else if(this.y<-5 && this.directionY && flag=="down"){
           downTag.innerHTML="下拉";
           flag="";
        }else if(this.y < maxScrollY-40 && this.directionY==1 &&!flag){
           upTag.innerHTML="释放加载！";
           this.maxScrollY = maxScrollY-40;
           flag="up";
        }else if( this.y > maxScrollY-40 && flag=="up" && this.directionY==-1){
           upTag.innerHTML="上拉";
           this.maxScrollY = maxScrollY;
           flag="";
        }
    });

    myScroll.on('scrollEnd',function() {
        if (!flag&& this.y<4 && this.y > -40) {//当
           this.scrollTo(0,-40,300);
           flag="";
        }else if(flag=="down"){
           downTag.innerHTML="加载中...";
           setTimeout(function(){
           	 fresh();
           },1000)
        }else if(flag=="up"){
          upTag.innerHTML="加载中...";
 		  setTimeout(function(){
           	  getList();
           },1000)
        };

    });

		function fresh(){           
           myScroll.scrollTo(0,-40,300);
           downTag.innerHTML="下拉";
           _refresh();
		}

        function getList(){
           var str = '<li>Pretty row new</li>'+
			'<li>Pretty row new</li>'+
			'<li>Pretty row new</li>'+
			'<li>Pretty row new</li>';
            $(ulDom).append(str);
            upTag.innerHTML="上拉";
            _refresh();
        };
        function _refresh(){
           flag="";
           myScroll.refresh();
           maxScrollY = myScroll.maxScrollY;
        }
document.addEventListener('touchmove', function (e) { e.preventDefault(); }, false);


    
});
</script>
</html>